 
\section{Review of the econometric methodology} \label{sec:Review}
%%% OBJECTIVE %%%
A main motivation for combining multivariate time series from individual entities by panel methods is to increase the sample size and thereby extend the available information set for a more precise estimation and higher test power.
%%% POOLING APPROACHES %%%
Table~\ref{tab:pcoint} provides an overview of the literature of panel cointegration rank tests. In this unifying framework, the rows of the table classify the \textit{pooling approach} according the different stages of hypothesis testing, at which the the cross-section information is presumed to be homogeneous. The listed pooling approaches allow for increasing heterogeneity between the individuals: (1)~Panel-homogeneous cointegrating vectors enable a pooled estimation of these long-run coefficients. (2)~The averaged statistic is standardized by moments of the distribution which the individual statistics have in common.\footnote{In fact, the univariate counterpart by \citet[p.~59, Remark~3.1]{ImPesaranShin2003} allows for individual-specific test distributions if their third moments exist. The approximating gamma distribution with its well-defined moments suggests that this holds true for cointegration rank tests. By the Lyapunov central limit theorem, the cross-sectional average of their first and second moments can then be used instead. In light of this, future studies may extend JMN \citeyearpar{JohansenEtAl2000} and KN \citeyearpar{KuritaNielsen2019} to panel tests with individual deterministic terms.} Finally, (3)~the meta-analytical combination of individual $p$-values is the most flexible approach, where the commonality aims at a consistent test decision under an increasing number of individuals. If the alternative hypothesis is true, a non-vanishing share of individuals must actually exhibit this property.

\begin{table}[ht]	% tab:pcoint
	\centering
	\caption{Panel tests for the rank of cointegration.}
	\resizebox{\textwidth}{!}{ 
		\input{tables/Tab_pcoint.tex}}
	\label{tab:pcoint}		
\end{table}

%%% GENERATIONS %%%
The columns of Table~\ref{tab:pcoint} represent the \textit{generations}, through which panel tests have evolved, and reflect the increasing complexity of the assumed data generating process. The first articles propose the plain approach for combining independent individual tests and thus are naive towards any dependencies between the individual entities. This cross-sectional dependence can emerge e.g.~between countries due to their trade and financial relations and is a research topic itself with regard to the global business cycle, the crude oil price, or other important commodities of the world market. The prevalent data property decreases the actual information content in macroeconomic panels compared to cross-independent samples of same size. First-generation tests then reject a correct null hypothesis more often than the nominal significance level and are thus ``over-sized''. In contrast, panel tests of the second generation maintain a correct test size and third-generation tests are robust against structural breaks additionally. For cointegration rank tests, the econometric literature considers structural breaks in the mean or linear trend of the cointegration relations. Empirical examples which are associated with shifts and with breaks in the linear time trend are the German reunification, the beginning of the Great Moderation, and its discussed end in the wake of the Great Recession. For a proper data representation, the VAR model must respect those changes in the long-run equilibrium, towards the error correction mechanism adjusts. Otherwise, the cointegration tests would miss to detect a reversion to the new equilibrium and thus understate the cointegration rank.

%%% BRANCHES / STRUCTURE OF THE REVIEW %%%
A third dimension of panel test construction is constituted by the underlying individual procedures, which have not been mapped onto Table~\ref{tab:pcoint}. These \textit{branches} are heterogeneous and often used side-by-side in a panel test article such that they do not follow such a clear pattern as the other two panel test properties do. This does not only hold for the example of cointegration tests, but also for VAR estimation and structural identification. All panel applications are confronted with similar construction problems and thus follow these dimensions in principle. Since the individual methods elude any classification scheme for Table~\ref{tab:pcoint}, Section~\ref{sec:Indiv} explains their technical details firstly and lays the foundation for Section~\ref{sec:Panel} presenting the panel methods along the two dimensions of Table~\ref{tab:pcoint}. The sections have the same structure according to estimation, testing, and identification as established in the individual and extended to the panel context respectively.

%%% NOTATIONS %%%
\textbf{Notations.} We adhere to the following rules. Subscript $ t = 1, \ldots, T $ denotes the periods and $ k = 1, \ldots, K $ refers to the endogenous variables in a multivariate time series. In order to simplify notation, Section~\ref{sec:Indiv} on the individual methods omits subscript $ i = 1, \ldots, N $ as the label specific to each of the $ N $ individuals. In contrast, Section~\ref{sec:Panel} uses subscript $ i $ to distinguish individual-specific elements also from homogeneous elements. Without any individual identifier $ i $, the latter must stay the same over the complete cross-section. Moreover, symbol $ \overset{d}{\longrightarrow} $ designates convergence in distribution. The $ (K \times (K-r)) $ matrix $ A_\perp $ is the orthogonal complement of a $ (K \times r) $ matrix $ A $ such that $ \text{rk} \lbrace [A : A_\perp] \rbrace = K $ indicates full rank and $ A_\perp'A=0 $. By convention, the orthogonal complement of a nonsigular square matrix is the zero matrix $ 0 $ and the orthogonal complement of zero matrix $ 0 $ is an identity matrix $ I_K $. With slight abuse of notation, integer $ r_\perp $ refers to the number of stochastic trends in a multivariate time series, corresponding to the cointegration rank $ r $.


\subsection{Individual methods} \label{sec:Indiv}
%%% VAR MODEL %%%
The basic unit for all presented panel methods is an individual VAR model of the form 
\begin{align} \label{eq:VAR}
	\boldsymbol{y}_{t} &= \Phi \boldsymbol{d}_{t} + A_1 \boldsymbol{y}_{t-1} + ... + A_p \boldsymbol{y}_{t-p} + \boldsymbol{u}_{t} \quad \textrm{with} \quad \boldsymbol{u}_{t} \sim (0,\Sigma_u) ,
\end{align}
where $\boldsymbol{y}_{t}$ is a vector of $ K $ stacked time series, $A_j, j=1,\ldots,p,$ are $ K \times K $ coefficient matrices for the VAR process of order $p$, and $ \Phi $ is a coefficient matrix for the deterministic regressors $ \boldsymbol{d}_{t} $. The errors $ \boldsymbol{u}_{t} $ are assumed to be serially, but not necessarily contemporaneously independent. Hence, the covariance matrix $ \Sigma_u $ is usually non-diagonal as the VAR model is estimated in reduced-form initially. Finding the structural shocks $ \boldsymbol{\epsilon}_{t} = \mathsf{B}^{-1} \boldsymbol{u}_{t} $, which exhibit no contemporaneous correlation, is the matter of structural identification in the the decomposition problem $ \Sigma_u = \mathsf{B} \mathsf{B}' $. The $ K $ variances of the structural shocks can be normalized to unity such that $ \boldsymbol{\epsilon}_{t} \sim ( 0, I_K ) $. Consequently, the unique identification of the impact matrix $ \mathsf{B}$ requires at least $ K(K-1)/2 $ restrictions on the $ K^2-K $ covariances in $ \Sigma_u $.

%%% VECM %%%
If $ \boldsymbol{y}_{t} $ is integrated of order $ I(1) $ at most and its first-differences $ \Delta \boldsymbol{y}_{t} $ are thus stationary, the VAR Model~\eqref{eq:VAR} in levels can be rewritten in its vector error correction representation
\begin{align} \label{eq:VECM}
\begin{split}
	\Delta \boldsymbol{y}_{t} \ & = \ \Phi \boldsymbol{d}_{t} + \Pi_{K} \boldsymbol{y}_{t-1} + \sum_{j=1}^{p-1} \Gamma_{j} \Delta \boldsymbol{y}_{t-j} + \boldsymbol{u}_{t} \quad \textrm{with} \quad \boldsymbol{u}_{t} \sim (0,\Sigma_u)
	\\ \textrm{using} & \quad \Pi_{K} := -I_K+\sum_{j=1}^{p} A_j \quad \textrm{and} \quad \Gamma_j := -\sum_{j^*=j+1}^{p} A_{j^*}, \ j=1,\ldots,p-1.
\end{split}
\end{align}
The $ K \times K $ coefficient matrix $ \Pi_{K} = \alpha\beta_{K}' $ of the error correction term summarizes the \mbox{$ K \times r $} cointegrating matrix $ \beta_{K} $ and loading matrix $ \alpha $, which adjusts the disequilibria in the $ r $ long-run cointegration relations $ \beta_{K}' \boldsymbol{y}_{t-1} $. The regressors $ \boldsymbol{d}_{t} $ of the deterministic term $ \Phi \boldsymbol{d}_t = \left[ \Phi_1 : \Phi_{2} \right] \left( \boldsymbol{d}_{1t}', \boldsymbol{d}_{2t}' \right)' $ are either unrestricted ($ \boldsymbol{d}_{2t} $) or restricted ($ \boldsymbol{d}_{1t} $) to the cointegration relations such that the coefficients $ \Phi_1 $ emerge from $ \Pi := \left[ \Pi_{K} : \Phi_1 \right] = \alpha \left[ \beta_{K}' : \beta_0' \right] = \alpha \beta' $. Finally, each $ \Gamma_{j} $ is a $ K \times K $ matrix of coefficients for short-run effects at lag $ j=1,\ldots,p-1 $.


\subsubsection{Estimating cointegrated VAR models} \label{sec:IndivEst}
\citet{Johansen1991,Johansen1996} provides a comprehensive collection of \textit{Maximum-Likelihood} methods for the individual VECM~\eqref{eq:VECM}. His ML-estimators and LR-tests are the foundation for any cointegrated VAR method of the \pkg{pvars} package. Hence, their definitions and components are throughout used in this article and shall be introduced here briefly. For convenience, firstly rewrite Model~\eqref{eq:VECM} in compact notation as
\begin{align} \label{eq:compactVECM}
\begin{split}
	Z_{0} \ & = \alpha\beta' Z_{1} + \Gamma Z_{2} + U \quad \text{now with} \quad \boldsymbol{u}_{t} \sim \mathcal{N}(0,\Sigma_u),
\end{split}
\end{align}
where the matrix $ \Gamma := \left[ \Gamma_1 : \cdots : \Gamma_{p-1} : \Phi_2 \right] $ lines up the coefficients for the short-run dynamics and for the unrestricted deterministic regressors. The observed time series are collected in the $ K \times T $ matrix $ Y := \left[ \boldsymbol{y}_{1}, \ldots, \boldsymbol{y}_{T} \right] $ for a sample $ 1,\ldots,T $ and the same holds for the error matrix $ U := \left[ \boldsymbol{u}_{1}, \ldots, \boldsymbol{u}_{T} \right] $, which contains no presample periods by construction of the estimation with lagging regressors. Accordingly, the regressand matrix is given by $Z_0 := \Delta Y $ and the two regressor matrices with $ T $ columns alike by
\begin{align} \label{eq:compactRegressor}
\begin{split}
	Z_1 := 
	\begin{bmatrix} 
		\boldsymbol{y}_{0}  & \ldots & \boldsymbol{y}_{T-1} \\ 
		\boldsymbol{d}_{11} & \ldots & \boldsymbol{d}_{1T} 
	\end{bmatrix}
	\quad \text{and} \quad
	Z_{2} \ & := 
	\begin{bmatrix}
		\Delta \boldsymbol{y}_{0}     & \ldots & \Delta \boldsymbol{y}_{T-1} \\
		                              & \vdots &                             \\
		\Delta \boldsymbol{y}_{1-p+1} & \ldots & \Delta \boldsymbol{y}_{T-p+1} \\
		\boldsymbol{d}_{21}           & \ldots & \boldsymbol{d}_{2T}
	\end{bmatrix}.
\end{split}
\end{align} 
The variables for the error correction term enter $ Z_1 $ in levels. $ Z_2 $ stacks the first-differenced and the unrestricted deterministic regressors. If $ p=1 $, all lagged $ \Delta \boldsymbol{y}_{t} $ drop out of $ Z_2 $. In conditional VECM, vectors of $ L $ (weakly) exogenous variables $ \boldsymbol{x}_t $ could be included as lagged $I(1)$ regressors into $ Z_1 $ as well as instantaneous and up to $ q $ lagged short-run effects into $ Z_2 $. The estimation would follow the same proceeding \citep[p.~398]{PesaranEtAl2000,Lutkepohl2005}, but we skip these terms here for the sake of notational brevity.


\textbf{ML-estimation.}\footnote{See \citet[Ch.~6]{Johansen1996}, \citet[Ch.~7.2.3]{Lutkepohl2005} and \citet[Ch.~3.1]{Lutkepohl2006} for a more detailed derivation and explanation.} The first order conditions from the maximized log-likelihood function
\begin{align} \label{eq:vecmLikeli}
\begin{split}
	\ln \mathcal{L} \left(\alpha, \beta, \Gamma, \Sigma_u \right) = & - \frac{KT}{2} \ln \left( 2\pi \right) - \frac{T}{2} \ln \left( \det ( \Sigma_u ) \right) \\
	& - \frac{1}{2} \text{tr} \left[ \left( Z_{0} - \alpha\beta' Z_{1} - \Gamma Z_{2} \right)' \ \Sigma_u^{-1} \ \left( Z_{0} - \alpha\beta' Z_{1} - \Gamma Z_{2} \right) \right]
\end{split}
\end{align} 
are solved for the estimators of VECM~\eqref{eq:compactVECM}, which corresponds to the following three steps:
\begin{enumerate}[label=\textbf{\arabic*.}]
	\item \textit{Concentrate out} short-run effects and the unrestricted deterministic term. The first step of $ \Pi $'s estimation is to remove the component $ \Gamma \boldsymbol{z_2}_t $ from $ \Delta \boldsymbol{y}_t $ and $ \boldsymbol{y}_t $ by OLS-regression of $ Z_0 $ resp. $ Z_1 $ on $ Z_{2} $. Using the Frisch-Waugh Theorem, the projection matrix $ M_2 := I_T - Z_2'(Z^{\ }_2 Z_2')^{-1} Z^{\ }_2 $ generates the ``long-run residuals'' $ R_{0} = Z_{0} M_2 $ resp. $ R_{1} = Z_{1} M_2 $ such that Model~\eqref{eq:compactVECM} collapses into the plain error correction model
	\begin{align} \label{eq:CoIntModel}
	\begin{split}
		Z_{0} M_2 & = \alpha\beta' Z_{1} M_2 + \Gamma Z_{2} M_2 + U M_2, \\
		R_{0} & = \alpha\beta' R_{1} + \widetilde{U}.
	\end{split}
	\end{align} 
	\item Estimate the concentrated Model~\eqref{eq:CoIntModel} by \textit{reduced-rank regression} (RRR) according to \citet{Anderson1951}.\footnote{See also \citet[Ch.~12.7]{Anderson2003} and \citet{Izenman1975}.} For doing so, define the moment matrices
	\begin{align} \label{eq:RRRmomat}
	\begin{split}
		S_{00} := \frac{R^{\ }_0 R_0'}{T}, \quad S_{01} := \frac{R^{\ }_0 R_1'}{T}, \quad \text{and} \quad S_{11} := \frac{R^{\ }_1 R_1'}{T}.
	\end{split}
	\end{align}
	Further inserting the OLS estimator~\eqref{eq:conOLS} for $ \widetilde{\alpha}(\beta) $ into the concentrated likelihood function transforms the ML maximization into the generalized eigenvalue problem
	\begin{align} \label{eq:RRReigen}
	\begin{split}
		\det \left( \lambda S_{11}^{\ } - S_{01}' S_{00}^{-1} S_{01}^{\ } \right) = 0.
	\end{split}
	\end{align} 
	This equation has $ K $ solutions with the ordered eigenvalues $ \lambda_1 \geq \lambda_2 \geq \ldots \geq \lambda_K \geq 0 $, which are the squared \textit{canonical correlation coefficients} and indicate the ``strength'' of cointegration in each solution. By the definition of cointegration, the correct coefficients $ \alpha\beta' $ must recombine the non-stationary $ R_{1} $ to the stationary $ R_{0} $. Hence, the estimator $ \widetilde{\beta} $ equals the eigenvectors of the $ r $ largest $ \lambda_j $ and is super consistent converging with rate $ T $ instead of the usual $ \sqrt{T} $ of the remaining OLS estimates. The $ r_\perp $ eigenvectors with the smallest $ \lambda_j $ are associated with the underlying stochastic trends and thus must cancel out from the henceforth \textit{rank-restricted} VECM.
	
	\item Maximize the log-likelihood function~\eqref{eq:vecmLikeli} conditional on a given $ \beta $, for which the super-consistent RRR-estimate $ \widetilde{\beta} $ can be inserted. The solution for the remaining estimators of the reduced-form VECM~\eqref{eq:compactVECM} are in fact \textit{conditional OLS}, namely
	\begin{align} \label{eq:conOLS}
	\begin{split}
		\widetilde{\Pi} & = \widetilde{\alpha} \beta' = \left[ R^{\ }_0 \left( \beta'R^{\ }_1 \right)' \left( \left( \beta'R^{\ }_1 \right) \left( \beta'R^{\ }_1 \right)' \right)^{-1} \right] \beta' = S_{01} \beta \left( \beta' S_{11} \beta \right)^{-1} \beta', \\
		\widetilde{\Gamma} & = \left( Z^{\ }_0 - \widetilde{\Pi} Z^{\ }_1 \right) Z_2'(Z^{\ }_2 Z_2')^{-1}, \\
		\widetilde{U} & = Z^{\ }_0 - \widetilde{\Pi} Z^{\ }_1 - \widetilde{\Gamma} Z^{\ }_2 = R^{\ }_0 - \widetilde{\Pi} R^{\ }_1.
	\end{split}
	\end{align}
\end{enumerate}
The residual covariance matrix is given by $ \widetilde{\Sigma}_u = \frac{\widetilde{U} \widetilde{U}'}{T} = S_{00} - \widetilde{\Pi} S'_{01} $ for ML estimation and is further corrected for $ n $, the number of coefficients per equation, in the OLS estimator $ \widehat{\Sigma}_u = \frac{T}{T-n} \cdot \widetilde{\Sigma}_u $. From Eq.~\eqref{eq:conOLS}, it becomes clear that only the loadings $ \widetilde{\alpha}(\beta) $ adjust towards the normalization of $ \beta $, while all other estimators are conditional on the complete matrix product $ \widetilde{\Pi} = \widetilde{\alpha} \beta' $. This shows that the cointegrated VAR process~\eqref{eq:VECM} and its impulse response functions (IRF) are invariant to any eligible normalization under a chosen rank $ r $ of $ \Pi $.


\textbf{GLS-based trend adjustment.} For the unique purpose of determining the cointegration rank, \citet{SaikkonenLutkepohl2000a} suggest to estimate and remove the deterministic term prior to an LM-test. \citet{SaikkonenLutkepohl2000c} apply the LR-statistic~\eqref{eq:LRrank} to the ``detrended'' time series, which may further improve the test power. This \textit{SL-procedure} entails a series of publications proposing different specifications of the deterministic term, which can be subsumed by the additive data generating process 
\begin{align} \label{eq:addDGP}
\begin{split}
	\boldsymbol{y}_{t} \ & = M_\mu \boldsymbol{d}_t + \boldsymbol{y}^{d \! t}_{t}, \\
	\boldsymbol{y}^{d \! t}_{t} \ & = A_{1} \boldsymbol{y}^{d \! t}_{t-1} + ... + A_{p} \boldsymbol{y}^{d \! t}_{t-p} + \boldsymbol{u}^{d \! t}_{t}.
\end{split}
\end{align}
Therein, the VAR process of the ``pure'' stochastic component $ \boldsymbol{y}^{d \! t}_{t} $ is usually abbreviated by a lag polynomial $ A(L) = I_K - A_1 L - \ldots - A_p L^p $. The $ K \times n_\mu $ matrix $ M_\mu $ collects the coefficients of the deterministic term in the moving-average representation of VAR~\eqref{eq:VAR}. Specifications of $ \boldsymbol{d}_t $ pursuant to the SL literature are listed in Table~\ref{tab:DetTerm} and illustrated in Section~\ref{sec:ERPT}.

%%% FGLS-ESTIMATION AS IN THE PVARS-PACKAGE %%%
All SL-procedures consider a \textit{GLS estimator} to determine $ M_\mu $. It becomes feasible by a preceding ML-estimation of VECM~\eqref{eq:VECM}, for which Table~\ref{tab:DetTerm} indicates also the conforming deterministic cases. Each hypothesis $ r_{H0} = 0,\ldots,K-1 $ in the test sequence then requires its specific rank-restriction on the ML-estimates and an own GLS estimation of $ M_\mu $. For this, the ML-estimates of the rank-restricted VECM are converted into $ \widetilde{A}_1, \ldots , \widetilde{A}_p $ of the VAR in levels and inserted into the transformed model
\begin{align} \label{eq:auxGLStrend}
\begin{split}
	{Q}' {A}(L) \boldsymbol{y}_t & = {Q}' {A}(L) M_\mu \boldsymbol{d}_t + {Q}' \boldsymbol{u}^{d \! t}_{t} \quad \text{for} \quad t=1,\ldots,T.
\end{split}
\end{align}
Therein, $ \boldsymbol{d}_t $ and $ \boldsymbol{y}_{t} $ are set to initial zeros in any presample period $ t \leq 0 $ and the feasible transformation matrix $ \widetilde{Q} $ is obtainable by inserting ML-estimates into
\begin{align} \label{eq:GLStrend}
\begin{split}
	Q & = \left[ \Sigma_u^{-1} \alpha \left( \alpha' \Sigma_u^{-1} \alpha \right)^{-1/2} : \alpha_\perp \left( \alpha_\perp' \Sigma_u \alpha_\perp \right)^{-1/2} \right].
\end{split}
\end{align}
The left-multiplication of $ {Q}' {A}(L) $ to \eqref{eq:addDGP} in \eqref{eq:auxGLStrend} allows for subtracting the confounding effects of the VAR dynamics and transforms the residual covariance matrix into $ I_K $. After vectorizing Model\eqref{eq:auxGLStrend}, $ M_\mu $ can thus be estimated by OLS. Alternatively, \citet[p. 438]{SaikkonenLutkepohl2000c} show that 
\begin{align} \label{eq:GLStrend2}
\begin{split}
	QQ' & \ = \ \Sigma_u^{-1} \alpha \left( \alpha' \Sigma_u^{-1} \alpha \right)^{-1} \alpha' \Sigma_u^{-1} + \alpha_\perp \left( \alpha_\perp' \Sigma_u \alpha_\perp \right)^{-1} \alpha_\perp' \ = \ \Sigma_u^{-1}.
\end{split}
\end{align} 
Accordingly, the GLS estimator based on the estimated covariance matrix $ \widetilde{\Sigma}_u $ can be applied directly to the data unaltered by $ \widetilde{Q} $, but still corrected for $ \widetilde{A}(L) $. Both proceedings lead to identical estimation results $ \widehat{M}_\mu $. Finally, the deterministic term is subtracted and the VECM of the stochastic component $ \boldsymbol{\hat{y}}^{d \! t}_{t} = \boldsymbol{y}_t - \widehat{M}_\mu \boldsymbol{d}_t $ is estimated by ML again -- now without any deterministic term. The usual LR-statistic~\eqref{eq:LRrank} can assess the sole null hypothesis of $ r_{H0} $, but its test distribution \eqref{eq:asympDistr} differs from the \citeauthor{Johansen1988} procedure.


\textbf{Deterministic term.} \citet{JohansenNielsen2018} distinguish between the \textit{innovative} and the \textit{additive} formulation of the deterministic term in Model~\eqref{eq:VECM} for the \citeauthor{Johansen1996} procedure resp.~in Model~\eqref{eq:addDGP} for the SL-procedure. Table~\ref{tab:DetTerm} adopts these labels and lists the model specifications. Like in a stable VAR process, the deterministic regressors $\boldsymbol{d}_t $ in VECM~\eqref{eq:VECM} can contain either no deterministic component, an intercept, or an additional linear trend. Beyond these ``standard'' types, non-stationarity and cointegration do complicate the estimation and testing in the presence of deterministic terms. For example, if a constant is assigned to $ \boldsymbol{d}_{2t} $, the unit roots in the VECM do not only accumulate the innovations $ \boldsymbol{u}_t $ into stochastic trends, but also this deterministic constant into a linear trend. On the other hand, the deterministic regressors $ \boldsymbol{d}_{1t} $ are restricted to the stationary cointegration relation and, thus, a linear trend in $ \boldsymbol{d}_{1t} $ does not generate a quadratic trend in the data. 
\begin{table}[ht]	% tab:DetTerm
	\centering
	\caption{Verified specifications of the deterministic term.}
	\resizebox{\textwidth}{!}{
		\input{tables/Tab_DetTerm.tex}}
	\label{tab:DetTerm}		
\end{table}
In the additive formulation of the SL-procedure, the stochastic component contains the unit roots so that they do not interfere with the deterministic component. Irrespective of the accumulating innovations, the deterministic term thereby retains its intended specification, as it is visible in the data, and can be easily subtracted after FGLS estimation. For this, each row in Table~\ref{tab:DetTerm} juxtaposes the specifications of the additive model and the corresponding term in the innovative VECM~\eqref{eq:VECM} which provides the parameters in Eq.~\eqref{eq:auxGLStrend} to~\eqref{eq:GLStrend2} for feasible GLS estimation.

%%% PERIOD-SPECIFIC DETERMINISTIC REGRESSORS %%%
Additionally to the conventional types, there can be period-specific shifts in the mean and breaks in the linear trend as well as impulse dummies for a single period or a repeated pattern of dummies for deterministic seasonality. Both test procedures retain the conventional asymptotics in Eq.~\eqref{eq:asympDistr2} if solitary impulse dummies are added or if the seasonal dummies in $ \boldsymbol{d}_{2t} $ are centered around zero and thus accumulate along a constant. In contrast, only the distributions $ Z_{r_\perp} $ of the SL-procedure are invariant to the inclusion of shift dummies irrespective of their known or estimated shift period and both procedures must cope with the nuisance introduced by broken trend slopes. \citeauthor*{JohansenEtAl2000} (JMN, \citeyear{JohansenEtAl2000}), \citeauthor*{KuritaNielsen2019} (KN, \citeyear{KuritaNielsen2019}) as well as \citeauthor*{TrenklerEtAl2008} (TSL, \citeyear{TrenklerEtAl2008}) provide solutions for the Johansen- and SL-procedure respectively. Note that, beyond these specification whose asymptotics are verified by the literature of Table~\ref{tab:DetTerm} and described in Section~\ref{sec:IndivTest}, \pkg{pvars} accepts all period-specific extensions technically and does not check their validity for the cointegration tests.

Like for the conventional types in Table~\ref{tab:DetTerm}, any regressor $ \boldsymbol{d}_{1t} $ in the cointegration term has a first-differenced counterpart in $ \boldsymbol{d}_{2t} $. While the additive model separates clearly between deterministic and stochastic components, the innovative VECM~\eqref{eq:VECM} mixes the structural breaks into the autoregressive dynamics. Hence, the innovative model implies not only a single, but additional lagged first-differences of the break over the periods $ \tau, \tau+1, \ldots, \tau+(p-1) $ after the break occurring in period $ \tau $. Their coefficients depend on the other model parameters and would require non-linear estimation. Against this, all authors of the reviewed literature accept a minor loss in degrees of freedom and prefer to estimate these coefficients separately without those restrictions. Like TSL \citeyearpar[p.~335]{TrenklerEtAl2008}, \pkg{pvars} sets lagged impulse dummies for $ \tau, \ldots, \tau+p-1 $ in $ \boldsymbol{d}_{2t} $ even after a trend break because, in combination with the shift in $ \tau $, they control for these non-linear dynamics the same way as lagged shift dummies. In return, a subsequent FGLS estimation of $ M_\mu $ in the additive Model~\eqref{eq:addDGP} uses the regressor matrix $ \boldsymbol{d}_t $ without these lagged first-differences. Besides the conventional term, it contains only the trend break and shift at the very same period $ \tau $ as illustrated in Eq.~\eqref{eq:detTerm}.


\subsubsection{Testing the cointegration rank} \label{sec:IndivTest}
In order to determine the cointegration rank $ r $ in the $ K $-dimensional System \eqref{eq:VECM}, all testing procedures imply a sequential decision making according to the hypotheses 
\begin{align} \label{eq:RankHypo}
\begin{split}
	H_0: \text{rk}\left( \Pi \right) = r_{H0} & \text{\quad versus \quad} H_1: \text{rk} \left( \Pi \right) > r_{H0}, \quad r_{H0}=0, \ldots, K-1.
\end{split}
\end{align}
As long as a null hypothesis is rejected, $r_{H0}$ is increased by $1$ and tested again. The procedure stops for an accepted $ r = r_{H0} $ or if the maximal $r_{H0} = K - 1$ has been rejected in favor of $ r = K $. Correspondingly, the number of stochastic trends\footnote{Note that in the \proglang{R} code of \pkg{pvars} and also often in the considered literature the variable $d$ denotes the number of stochastic trends instead of the less ambiguous $ r_\perp $.} $ r_\perp = K - r_{H0} $ declines in each step from $K$ down to $1$. Note that, under a given $r_{H0}$, the \textit{maximum eigenvalue test} builds on the $ H_ 1 $ of $ \text{rk}(\Pi) = r_{H0} + 1 $ and the \textit{trace test} on $ \text{rk}(\Pi) = K $. Although both tests are applicable to panel extensions, only variants of the trace test have been adopted by the panel literature and are thus introduced here.


\textbf{LR-test.} \citet{Johansen1988} develops a nowadays predominant \textit{likelihood ratio} test which compares the maximized likelihood $ \mathcal{L}(r_{H0}) $ from the rank-restricted model against the likelihood $ \mathcal{L}(K) $ from the full-rank model with $ K $ variables. This trace statistic denotes as
\begin{align} \label{eq:LRrank}
\begin{split}
	\lambda^{\text{LR}} \left( r_{H0} \right) & = -2 \left[ \ln \mathcal{L}(r_{H0}) - \ln \mathcal{L}(K) \right] \\
	& = -T \sum_{j=r_{H0}+1}^{K} \ln(1-\hat{\lambda}_j) \ \overset{d}{\longrightarrow} \ Z_{r_\perp}. 
\end{split}
\end{align}
The estimated eigenvalues $ \boldsymbol{\hat{\lambda}} $ are the squared canonical correlation coefficients obtained from the RRR in Section~\ref{sec:IndivEst} and resemble the ordered eigenvalues of coefficient matrix $ \Pi $. Correspondingly, this test assesses whether any of the $ r_\perp $ smallest eigenvalues is significantly different from zero and thus increases the rank of $ \Pi $. Under $ H_0 $, the asymptotic test distribution is a function of $ r_\perp $-dimensional Brownian motions as outlined in Eq.~\eqref{eq:asympDistr}.


\textbf{LM-test.} Albeit its shadow existence in the individual time series methodology, the \textit{Lagrange multiplier} test adopted by \cite{LuukkonenEtAl1999} has proven useful for the panel test procedure proposed by \cite{Breitung2005} as it can serve as a vehicle to introduce the panel-homogeneous cointegrating vectors into an individual testing procedure. In order to make the cointegration rank $ r_{H0} $ testable by LM, the concentrated Model~\eqref{eq:CoIntModel} is extended by $ \phi \beta_\perp' R_{1} $ and multiplied by $ \alpha_\perp' $. Consequently in the auxiliary model
\begin{align} \label{eq:auxLMrank}
\begin{split}
	R_{0} & = \alpha \beta' R_{1} + \phi \beta_\perp' R_{1} + U^{{L \! M}} \\
	\text{resp. \quad}	\alpha_\perp' R_{0} & = \phi^* \beta_\perp' R_{1} + \alpha_\perp' U^{{L \! M}},
\end{split}
\end{align}
the extension is $ H_0: \alpha_\perp' \phi = \phi^* = 0_{r_\perp \times r_\perp} $ under $ r_{H0} $, but converts $ \Pi = \alpha \beta' + \phi \beta_\perp' $ into a full-rank matrix if the data suggest the alternative $ H_1: \text{rk}(\Pi) = K $. After inserting suitable estimates for the orthogonal complements,\footnote{For his panel cointegration test, \citet{Breitung2005} uses the individual first-step estimate for $ \alpha_i $ and the pooled second-step estimate for $ \beta_K $ under rank-restriction $ r_{H0} $. In \pkg{pvars}, their orthogonal complements are then calculated via the QR-decomposition as done in the \pkg{MASS} package \citep{VenablesRipley2002}.} the coefficient matrix $ \phi^* $ is estimated by OLS with regressand $ E := \widehat{\alpha_\perp}' R_0 $ and regressor $ W := \widehat{\beta_\perp}' R_1 $. The test statistic for $ H_0: \phi^* = 0 $ is constructed according to the here all-equivalent LR-, Wald-, or LM-principle and is thus directly calculated with
\begin{align} \label{eq:LMrank}
	\lambda^{\text{LM}} \left( r_{H0} \right) & = T \ \text{tr} \left[ EW' \left( WW' \right)^{-1} WE' \left( EE' \right)^{-1} \right] \ \overset{d}{\longrightarrow} \ Z_{r_\perp}.
\end{align}
This LM-test statistic and Johansen's LR-test statistic from Eq.~\eqref{eq:LRrank} are asymptotically identical and so are their test distributions.


\textbf{Test distribution.}\footnote{See \citet[Ch.~11.2]{Johansen1996}, \citet[Ch.~8.2]{Lutkepohl2005}, and \citet[p.~24, Eq.~2.9]{Trenkler2008}.} Under $ H_0 $ and $ T \to \infty $, the theoretical distributions converge to
\begin{align} \label{eq:asympDistr}
\begin{split}
	Z_{r_\perp} & = \text{tr} \left[ \int_0^1 \left(\text{d} W^\circ_{r_\perp} \right) W_{r_\perp}^{\bullet'} \ \left( \int_0^1 W^\bullet_{r_\perp} W_{r_\perp}^{\bullet'} \right)^{-1} \int_0^1 W^\bullet_{r_\perp} \left(\text{d} W^\circ_{r_\perp}\right)' \right]
\end{split}
\end{align}\\[-27pt]
\begin{align} \label{eq:asympDistr2}
\begin{split}
	\text{with \quad} W^\bullet_{r_\perp} & := 
	\begin{cases}
	W_{r_\perp} {\left( s \right)} & \text{for \textit{Case 1} or \textit{SL\_mean} } \\
	W_{r_\perp} {\left( s \right)} - \int_0^1 W_{r_\perp}{\left( s \right)}\text{d} s & \text{for \textit{Case 2} } \\
	\left[ \begin{smallmatrix}
	W_{r_\perp-1} {\left( s \right)} \\ s
	\end{smallmatrix} \right] - \int_0^1 \left[ \begin{smallmatrix}
	W_{r_\perp-1} {\left( s \right)} \\ s
	\end{smallmatrix} \right] \text{d} s & \text{for \textit{Case 3} } \\
	W_{r_\perp} {\left( s \right)} - sW_{r_\perp}{\left( 1 \right)} & \text{for \textit{Case 4} or \textit{SL\_trend}} \\
	\end{cases} \\
	\text{and \quad} \text{d} W^\circ_{r_\perp} & := 
	\begin{cases}
	\text{d} W_{r_\perp} {\left( s \right)} & \text{for \textit{SL\_mean} or any \textit{Case}} \\
	\text{d} W_{r_\perp} {\left( s \right)} - \text{d} sW_{r_\perp}{\left( 1 \right)} & \text{for \textit{SL\_trend}.} \\
\end{cases}
\end{split}
\end{align}
The $ r_\perp $-dimensional vector $ W_{r_\perp} {\left( s \right)} $ stacks the independent standard Brownian motions. In Eq.~\eqref{eq:asympDistr}, their vector products are integrated over their complete domain $ s \in [0,1] $. If the VECM accommodates deterministic regressors, $ W^\bullet_{r_\perp} {\left( s \right)} $ must be specified accordingly. Eq.~\eqref{eq:asympDistr2} lists the Brownian motions resp.~bridges for the conventional cases from Table~\ref{tab:DetTerm}. In contrast to those, trend breaks are specific to the periods of their occurrence and the relative position of these periods within the sample affects $ Z_{r_\perp} $ additionally. Also note that any unrestricted deterministic term which is accumulated under $ I(1) $, e.g.~the constant in \textit{Case 3}, dominates the stochastic trends and thus replaces a Brownian motion in $ W_{r_\perp} {\left( s \right)} $.

The asymptotic distribution of $ Z_{r_\perp} $ is non-standard, therefore critical values have been simulated e.g.~by \cite{OsterwaldLenum1992}. For this, $ W_{r_\perp} $ is substituted by a repetitive simulation of $ r_\perp $-dimensional vectors of Gaussian random walks with sufficiently\footnote{For example, \citet[Ch.~15]{Johansen1996} recommends $T=400$. \citet[p.~171, App.~B]{Breitung2005} employs $ T=500$ and \citet{OersalDroge2014} $ T=1000 $ in order to simulate the respective moments of $ Z_{r_\perp} $.} large sample size. Also, $ Z_{r_\perp} $ can be approximated by the gamma distribution $ \Gamma (\mathsf{s}, \mathsf{r}) $, whose continuous probability density function offers the advantage of retrieving $p$-values conveniently. In order to do so, its shape- and rate-parameters are equated with
\begin{align} \label{eq:GammaParameter}
\begin{split}
	\mathsf{s} = \frac{\mathbb{E}(Z_{r_\perp})^2}{ \text{Var}(Z_{r_\perp}) } \qquad \text{and} \qquad \mathsf{r} = \frac{\mathbb{E}(Z_{r_\perp})}{ \text{Var}(Z_{r_\perp}) }.
\end{split}
\end{align}
Simulated values for the moments $ \mathbb{E}(Z_{r_\perp}) $ and $ \text{Var}(Z_{r_\perp}) $ can be found for example in \citet{LarssonEtAl2001} and \citet{Breitung2005}.\footnote{\citet{LarssonEtAl2001} provide moments of $ Z_{r_\perp} $ only for \textit{Case~1} and \citet{Breitung2005} for \textit{Case~2} to \textit{Case~4} in order to center and scale the LR-bar panel test statistic as in Eq.~\eqref{eq:LRbar}. In \pkg{pvars}, these moments are stored in the list object \code{coint\_moments}.} Like the unknown theoretical distribution $ Z_{r_\perp} $, their simulation depends on \textit{(i)} the number of stochastic trends $ r_\perp $ under $ H_0 $, \textit{(ii)} the deterministic term, and \textit{(iii)} the number of weakly exogenous variables in a conditional VECM. Hence, the different test specifications imply a grid of simulation setups to run.

More flexibility towards adapting these specifications is offered by response surface approximation of the moments as employed by \citet{Doornik1998}. For each \textit{Case}, he estimates response surface coefficients\footnote{In \pkg{pvars}, the response surface coefficients are stored in the list object \code{coint\_rscoef}.} of a polynomial regression model $ f(r_\perp) $ which ``predicts'' the moments of $ Z_{r_\perp} $ for \citet{Johansen1996}. \citet{Trenkler2008} derives response surface coefficients specifically for the trend-adjusted tests of Eq.~\eqref{eq:addDGP}. TSL \citeyearpar{TrenklerEtAl2008} tabulate these coefficients for trend-adjusted tests which accommodate structural trend breaks in the conintegration relationship. Likewise, JMN \citeyearpar{JohansenEtAl2000} consider structural breaks in the constant and in the linear trend of the innovative model, which KN \citeyearpar{KuritaNielsen2019} generalize for conditional VECM by \citet[Ch.~9]{Doornik1998}. Although both models, additive and innovative, can cope with several breaks in principle, the regression models $ f \left(r_\perp, \frac{\boldsymbol{\tau}}{T} \right) $ by JMN \citeyearpar{JohansenEtAl2000}, KN \citeyearpar{KuritaNielsen2019}, and TSL \citeyearpar{TrenklerEtAl2008} contain polynomials of up to two break periods $ \boldsymbol{\tau} $ only. \pkg{pvars} resorts to the respective approximation automatically in order to comply with the test specification selected by the user.



\subsubsection{Identifying structure}
Based on the given rank-restriction $ r $ and structural shocks $ \boldsymbol{\epsilon}_{t} = \mathsf{B}^{-1} \boldsymbol{u}_{t} $, the VECM~\eqref{eq:VECM} can be transformed according to the \textit{Granger representation theorem} (GRT) into
\begin{align} \label{eq:GRT}
\begin{split}
	\boldsymbol{y}_{t} \ & = \ \Xi \mathsf{B} \sum_{j=1}^{t} \boldsymbol{\epsilon}_{j} + \sum_{j=0}^{\infty} \Xi^{*}_{j} \mathsf{B} \boldsymbol{\epsilon}_{t-j} + \Xi \Phi \sum_{j=1}^{t} \boldsymbol{d}_{j} + \sum_{j=0}^{\infty} \Xi^{*}_{j} \Phi \boldsymbol{d}_{t-j} + \boldsymbol{y}^{*}_{0} \quad \text{with} \\
	\Xi \ & = \ \beta_{\perp} \left[ \alpha_{\perp}' \left(I_K - \sum_{j=1}^{p-1} \Gamma_{j} \right) \beta_{\perp} \right]^{-1} \alpha_{\perp}'.
\end{split}
\end{align}
The initial vector $ \boldsymbol{y}^{*}_{0} $ and the deterministic terms are usually dropped in order to trace the responses to an isolated structural impulse $ \epsilon_{(k)} $. The number of stochastic trends $\text{rk}(\Xi) = K-r = r_\perp $ follows from the $ K \times r_\perp $ orthogonal complements $ \alpha_{\perp} $ and $ \beta_{\perp} $ for the $ K \times r $ loadings $ \alpha $ and cointegrating vectors $ \beta_K $. Their different specifications illustrate the role of the components in \eqref{eq:GRT} and their options for structural restrictions:
\begin{itemize}
	\item If $ r_\perp = 0 $, the stochastic trends cancle out and the sole multiplier matrices $ \Xi_j^* \mathsf{B} $ reflect the IRF of the implied \textit{stable} SVAR model. Hence, just-identification requires the $ K(K-1)/2 $ restrictions to be imposed on the instantaneous effects $\mathsf{B} $ exclusively. A simple example is \cite{Sims1980}, who assumes recursive (short-run) causality such that the structural effects on impact can be calculated by $ \widehat{\textsf{B}} = \text{chol} \left( \widehat{\Sigma}_{u} \right) $.
	
	\item If $ r_\perp = K $, VECM~\eqref{eq:VECM} loses its error correction term and is estimated as a first-differenced VAR model by OLS~\eqref{eq:conOLS}. Since $ \alpha_\perp = \beta_\perp = I_K $, matrix $ \Xi = \left(I_K - \sum_{j=1}^{p-1} \Gamma_{j} \right)^{-1} = \Gamma(1)^{-1} $ is full-rank and $ K(K-1)/2 $ long-run restrictions are sufficient for identifying this SVAR of \textit{growth rates} $ \Delta \boldsymbol{y}_{t} $. In this example, recursive long-run causality is imposed on the structural long-run effects $ \Xi \mathsf{B} $ such that $ \widehat{\textsf{B}} = \widetilde{\Gamma}(1) \ \text{chol}\left( \widehat{\Sigma}_{\infty} \right) $ is calculated via the long-run covariance $ \Sigma_\infty := \Xi \mathsf{B} \mathsf{B}'\Xi' = \Gamma(1)^{-1} \Sigma_u \Gamma(1)'^{-1} $. 
	
	\item A cointegration rank $ r $ implies $ r_\perp $ permanent shocks at minimum and conversely $ r $ transitory shocks at maximum. Identifications schemes in the tradition of \citet{KingEtAl1991} assume that $ \Xi \mathsf{B} $ is rank-deficient due to $ r $ columns of $ {\bf 0}_K $. Each $ {\bf 0}_K $ suppresses the stochastic trends and thus defines a transitory shock in $ \boldsymbol{\epsilon}_{t} $. Other formulations of the rank-deficiency may lead to fewer transitory shocks.
\end{itemize} 


\textbf{ML-estimation.}\footnote{See \citet{Vlaar2004}, who imposes linear short- and long-run restriction with restriction matrices for the cases of just- and over-identification. Compare also to \citet[Ch.~11, p.~331]{Hamilton1994}, \citet[Ch.~3.2, p.~84]{Lutkepohl2006}, and \citet[Ch.~11.2.2 and p.~315]{KilianLutkepohl2017} as a full-information MLE.} The impact matrix $ \mathsf{B} $ can be estimated by ML via $ \mathcal{L} \left(\alpha, \beta, \Gamma, \mathsf{B} \right) $ as an extension of Eq.~\eqref{eq:vecmLikeli}. Inserting the reduced-form estimates from Section~\ref{sec:IndivEst} facilitates a conditional ML-estimation of $ \mathsf{B} $ as Step~\textbf{4.} with the concentrated likelihood function
\begin{align} \label{eq:svecmLikeli}
\begin{split}
	\ln \mathcal{L}_c \left( \mathsf{B} \right) = & - \frac{KT}{2} \ln \left( 2\pi \right) - \frac{T}{2} \ln \left( \det ( \mathsf{B} ) \right)^2 - \frac{1}{2} \text{tr} \left[ \mathsf{B'}^{-1} \mathsf{B}^{-1} \widetilde{\Sigma}_u \right].
\end{split}
\end{align}
This constrained maximization problem has no closed-form solution. Hence, \cite{BreitungEtAl2004} maximize $ \mathcal{L}_c \left( \mathsf{B} \right) $ with respect to the free parameters subject to the identifying restrictions numerically by the scoring algorithm of \citet{AmisanoGiannini1997}. If the number of short- and long-run restrictions suffice just-identification only, the equality $ \widetilde{\Sigma}_u = \mathsf{\widetilde{B}} \mathsf{\widetilde{B}}' $ holds and the scoring algorithm serves as a non-linear equation solver.


\subsection{Panel methods} \label{sec:Panel}

\subsubsection{Estimating cointegrated VAR models}
In macroeconomic panels, the idiosyncrasies of countries can subvert the objective to increase estimates' precision with pooled data. Deterministic effects like intercepts are usually kept individual-specific in panel data analysis, but even the assumption of homogeneous slope coefficients can be too restrictive. \citet{PesaranSmith1995} demonstrates how systematic differences between individual dynamics lead to inconsistent estimates and consequently deny poolability. As an economically plausible middle ground, \citet{PesaranEtAl1999} propose a selective pooling for single-equation models, where only the long-run relationship is homogeneous across all individuals, while the short-run dynamics are considered as heterogeneous. The following panel estimators adopt this principle into a system of equations and restrict the $ r $ cointegrating vectors $ \beta_i = \beta \ \forall \ i $. Although the individual VECM~\eqref{eq:VECM} does not require the basic normalization of the error correction term as single-equation models do, a panel-wide normalization becomes necessary in order to extract the homogeneous $ \beta $ from the individual coefficient matrices $ \Pi_i = \alpha_i \beta' $.


\textbf{Two-step estimator.}\footnote{See also \citet[Ch.~7.2.2]{Lutkepohl2005} or \citet{BruggemannLutkepohl2005} about GLS estimation of the individual cointegration parameters. In fact, Eq.~\eqref{eq:2S_GLS} reduces to this GLS estimator if there is only $ N=1 $ individual entity. Moreover, \citet[Ch.~7.3.2]{Lutkepohl2005} and \citet[p.~159]{Breitung2005} consider restricted $ \beta $.} 
\citet{Breitung2005} extends the individual two-step estimator by \citet{AhnReisel1990} to a panel estimator for $\beta$. Based on the panel-wide normalization $\Pi_i = \alpha_i \left[I_r : \mathbf{B} \right] = \left[ \alpha_i I_r : \alpha_i \mathbf{B} \right] \ \forall \ i $, he transforms the concentrated Model~\eqref{eq:CoIntModel} into
\begin{align} \label{eq:2S_stack}
\begin{split}
	R^{\ }_{0,i} - \alpha_i I_r R_{1,i}^{(1)} & = \alpha_i \mathbf{B} R_{1,i}^{(2)} + U_{i} \text{\quad with \quad}
	R_{1,i} = \begin{bmatrix} R_{1,i}^{(1)} \\ R_{1,i}^{(2)} \end{bmatrix} \\
\end{split}
\end{align}
partitioned into $ R_{1,i}^{(1)} $ as the $ r $ upper time series and $ R_{1,i}^{(2)} $ as the remaining $ r_\perp $ time series and $ n_1 $ restricted deterministic regressors. The left-multiplication $ \alpha_{i}^{(+)} \alpha_i = I_r $ eliminates the individual loadings $ \alpha_{i} $ in Eq.~\eqref{eq:2S_stack} such that Model~\eqref{eq:CoIntModel} is further transformed into
\begin{align} \label{eq:2S_aux}
\begin{split}
	\alpha_{i}^{(+)} \left(R^{\ }_{0,i} - \alpha_{i} R_{1,i}^{(1)} \right) & = \mathbf{B} R_{1,i}^{(2)} + \alpha_{i}^{(+)} U_{i} \text{\quad using \quad} \alpha_{i}^{(+)} = \left( \alpha_i' \Sigma_{u,i}^{-1} \alpha_i \right)^{-1} \alpha_i' \Sigma_{u,i}^{-1}. \\
\end{split}
\end{align}
The \textit{pooled OLS estimator} of the homogeneous $ \mathbf{B} $, i.e.~the right $ r \times \left( r_\perp + n_1 \right) $ block of the normalized and transposed cointegrating matrix, yields the second step given by
\begin{align} \label{eq:2S_GLS}
\begin{split}
	\widehat{\mathbf{B}}_{2S} & = R_0^{(+)} R_1^{(2)'} \left( R_1^{(2)} R_1^{(2)'} \right)^{-1}
\end{split}
\end{align}
\begin{align}
	\text{with regressand} \quad R^{(+)}_{0,i} & := \alpha_{i}^{(+)} R^{\ }_{0,i} - R_{1,i}^{(1)} & \text{collected in} \quad R_0^{(+)} := \begin{bmatrix} R^{(+)}_{0,1} : \cdots : R^{(+)}_{0,N} \end{bmatrix} & \nonumber \\
	\text{and regressor} \quad R_{1,i}^{(2)} &  & \text{collected in} \quad R_1^{(2)} := \begin{bmatrix} R_{1,1}^{(2)} : \cdots : R_{1,N}^{(2)} \end{bmatrix} &. \nonumber
\end{align}
For feasible estimation, inserting any $ \sqrt{T} $-consistent estimates for $ \alpha_i $ and $ \Sigma_{u,i} $ leaves the limiting distribution of the estimator~\eqref{eq:2S_GLS} unaffected. This first step may be the individual ML-estimation of each VECM, which concentrates out the short-run effects and unrestricted deterministic terms $ \Gamma_i Z_{2,i} $ from the observed time series as well. Under rank-restriction $ r $, the second-step estimates $ \widehat{\mathbf{B}}_{2S}$ thereby $ T\sqrt{N} $-consistently \citep[p.~156, Th.~1]{Breitung2005}. Overall, this procedure thus follows the steps of the ML-estimation, but sets a pooled estimation on top of the individual reduced-rank regressions~\eqref{eq:RRReigen}. Like in third step of the individual ML-estimation, the cointegrating matrix $ \widehat{\beta}' = \begin{bmatrix} I_r : \widehat{\mathbf{B}}_{2S} \end{bmatrix} $ can be reintroduced into the conditional OLS~\eqref{eq:conOLS} of the individual parameters, for which product moments are already available from the first step. Thereof, the estimates for $ \alpha_i $ and $ \Sigma_{u,i} $ -- now conditional on the pooled $ \widehat{\beta} $ -- can be used in Eq.~\eqref{eq:2S_GLS} again. \citet[p.~195]{HlouskovaWagner2010} expand this principle and iterate conditional OLS and second-step estimation alternately until reaching convergence of the estimates $ \widehat{\mathbf{B}}_{2S} $.


\textbf{Deterministic term.} Since the first estimation step \eqref{eq:CoIntModel} removes the unrestricted regressors $ \boldsymbol{d}_{2,it} $ from the error correction Model~\eqref{eq:VECM}, the coefficients $ \Phi_{2i} $ are individual-specific by construction. In consequence, the homogeneity restriction $ \beta_{K,i} = \beta_K $ in 
\begin{align} \label{eq:2S_det}
\begin{split}
	\Pi_i := \left[ \Pi_{K,i} : \Phi_{1,i} \right] = \alpha_i \left[ \beta_{K}' : \beta_{0i}' \right] = \alpha_i \left[I_r^{\ } : \mathbf{B}_{\ }^{(2)} : \mathbf{B}_i^{(3)} \right]
\end{split}
\end{align}
implies one additional choice for specifying the innovative deterministic term in Table~\ref{tab:DetTerm}:\footnote{\citet[Ch.~4.1]{GroenFrank2003} give an overview on the different combinations that emerge from this single additional option.} 
The coefficients for $ D_{1,i} M_{2i} $ can be defined as having some homogeneous $ \beta_{0i} = \beta_{0} \ \forall \ i $ or individual-specific effects $ \beta_{0i} $. For example, \textit{Case 2} with heterogeneous intercepts $ \beta_{0i} $ and $ p_i = 1 \forall i $, i.e.~without the need to correct for lagged short-run effects by $ M_{2i} $, adds \textit{fixed-effects} to the auxiliary Model~\eqref{eq:2S_aux}. The regressors of such individual-specific $ \mathbf{B}_i^{(3)} $ are partialled out from the pooled regression beforehand, while $ \mathbf{B}^{(2)} $ is simply extended by the $ r \times n_1 $ homogeneous $ \beta_{0}' $ and estimated by the pooled $ \widehat{\mathbf{B}}_{2S} $ of \eqref{eq:2S_GLS}. Note however that $ \Phi_{1i} = \alpha_{i} \beta_{0}' $ remains heterogeneous irrespective of the homogeneity restriction on $ \beta_{0} $.


\subsubsection{Testing the cointegration rank}
Like the individual tests in Section~\ref{sec:IndivTest}, the following panel tests evaluate the hypothetical cointegration rank $ r_{H0}=0,...,K-1 $ within a sequential testing procedure. Each of the $ N $ individuals must have observations on the same $ K $ variables so that the hypothesis pair on the heterogeneous ranks $ r_i $ in the individual VAR processes $ \boldsymbol{y}_{it} $ can be stated as
\begin{align} \label{eq:Hypothesis}
\begin{split}
	H_0: \bar{r} = r_{H0} & \text{\quad versus \quad} H_1: \text{rk}\left( \Pi_i \right) > r_{H0} \ \text{for some} \ i \\
	\text{with} \ \bar{r} = & \max \{ \text{rk}\left( \Pi_i \right) \mid i=1,..,N \}.
\end{split}
\end{align}
While a statistical heterogeneity in $ r_i $ lets the sequential procedure find the maximum rank among the individual processes, the theoretical context might allow for the more restrictive assumption of homogeneous cointegration ranks across all individuals $ i=1,\ldots,N$. Accordingly, the hypothesis pair~\eqref{eq:Hypothesis} would adopt a common rank $ r_i = \bar{r} = r $. \citet[p.~9]{SilvestreSurdeanu2011} assume this ``for the panel data based procedure to make sense'' and the homogeneous cointegrating vectors $ \beta_{K,i} = \beta_K $ in \citet{Breitung2005} and \citet{GroenFrank2003} actually have the statistical implication of $ r_i = r $.


\textbf{Pooled cointegrating vectors.} The more restrictive assumption of homogeneous $ \beta_K $ allows for a pooled estimation to further increase the test power. Only in this case, the \textit{pooling} and the \textit{combination} approach of the panel test differ. After estimating individual models with pooled $ \beta_K $, \citet{Breitung2005} combines the individual LM-test~\eqref{eq:LMrank} results by their averaged statistics~\eqref{eq:LRbar}. Originally, he does not make use of the gamma distribution to derive $p$-values of the LM-tests. Since this option follows straightforwardly from the asymptotic equivalence of LM- and LR-test, \pkg{pvars} implements their meta-analytical combination, too.\footnote{\citet[p.~268]{Choi2001} shows for the univariate case of panel unit root tests that especially the inverse normal test has a favorable power in comparison to the panel test of averaged statistics.} Thereby, both combination approaches are available to shrink the vectors of $ N $ test results into scalar decisions. The following section refers to these combination approaches, which are congruent with the pooling approaches of Table~\ref{tab:pcoint}.


\textbf{Combination approaches.} Extending the combination idea from \citet{ImPesaranShin2003} to the multivariate case of $ K $ variables, \cite{LarssonEtAl2001} use the \textit{cross-sectional average} of individual test statistics $ \lambda^\bullet_i $, which are standardized by the first and second moment. Accordingly, the so-called LR-bar test statistic $ \Upsilon_{\overline{LR}} $ is calculated as
\begin{align} \label{eq:LRbar}
\begin{split}
	\overline{\lambda} (r_{H0}) & =\frac{ \sum_{i=1}^{N} \lambda^\bullet_i \left( r_{H0} \right) }{N}, \\
	\Upsilon_{\overline{LR}} & = \frac{\sqrt{N} \left( \overline{\lambda} (r_{H0}) - \mathbb{E}\left( Z_{r_\perp} \right) \right) }{ \sqrt{ \text{Var}\left( Z_{r_\perp} \right) } } \ \overset{d}{\longrightarrow} \ \mathcal{N}(0,1)
\end{split}
\end{align}
and follows asymptotically a standard normal distribution under $ H_0 $ as $ T \to \infty $ and subsequently $ N \to \infty $. This holds also if $ T,N \to \infty $ simultaneously, but $ T $ has a faster limiting rate such that $ \sqrt{N}/T \to 0 $. The combination approach itself is well-established for all kinds of panel tests. The key contribution by \cite{LarssonEtAl2001} is to prove that the moments of the asymptotic distribution $ Z_{r_\perp} $ exist.\footnote{See also the corrigendum by \citet{OersalDroge2011}.} Likewise, \citet{OersalDroge2014} present and utilize a proof for the detrending panel SL-test with the deterministic type \textit{SL\_trend}. Additionally, \pkg{pvars} offers the specification \textit{SL\_mean} because the existence of the related moments follows directly from the identity of $ Z_{r_\perp} $ for \textit{SL\_mean} and \textit{Case 1} -- see Eq.~\eqref{eq:asympDistr2}. 

Following the \textit{meta-analytical combination} of $p$-values, \citet{Choi2001} uses different combination methods on the individual $p$-values denoted by $ p_i $. The first combination test, which \citet{Fisher1932} originally proposed and \citet{MaddalaWu1999} embraced for tests in non-stationary panels, is the inverse chi-square test. Its statistic is stated as
\begin{align} \label{eq:Choi_P}
\begin{split}
	P & = - 2 \sum_{i=1}^{N} \ln\left( p_i \right) \ \overset{d}{\longrightarrow} \ \mathcal{\chi}^2(2N)  % right-tailed test
\end{split}
\end{align}
under the asymptotics of $ T_i \to \infty $ while $ N $ being fixed. In the limit of $ N $, the distribution of $ P $ degenerates however. Hence for panels with many\footnote{\citet[p.~268]{Choi2001} states for panel unit root tests that, even with samples of $N=100$, $P_m$ does not follow its asymptotic distribution closely. In contrast to the two Fisher tests, the test size of the inverse normal test and of the averaged statistics is more robust to any choice of $ N $.} individuals, \citet{Choi2001} standardizes $ P $ by the moments of the $ \chi^2 $-distribution and proposes the modified statistic
\begin{align} \label{eq:Choi_Pm}
\begin{split}
	P_m & = \frac{ \sum_{i=1}^{N} \left( \ln\left( p_i \right) + 1 \right) }{\sqrt{N}} \\ 
	& = \frac{P - 2N}{\sqrt{4N}} \ \overset{d}{\longrightarrow} \ \mathcal{N}(0,1), % right-tailed test
\end{split}
\end{align}
when $ T_i \to \infty $ and then additionally $ N \to \infty $. Furthermore, assuming the same limiting data dimensions, \citet{Choi2001} uses the inverse normal test
\begin{align} \label{eq:Choi_Z}
\begin{split}
	Z & = \frac{ \sum_{i=1}^{N} \Phi^{-1} \left( p_i \right) }{\sqrt{N}} \ \overset{d}{\longrightarrow} \ \mathcal{N}(0,1) % left-tailed test
\end{split}
\end{align}
from \citet{StouferEtAl1949} for non-stationary panel data analysis. Here, $\Phi^{-1} \left( \bullet \right) $ denotes the probit function, i.e.~the inverse of the standard normal cumulative distribution.


\textbf{PANIC.} The \textit{Panel Analysis of Non‐stationarity in Idiosyncratic and Common components} by \cite{BaiNg2004} accounts for cross-sectional dependency stemming from unobserved common factors, which could be stationary, integrated, or both coexistent. Arsova and Örsal \citeyearpar{ArsovaOersal2017,ArsovaOersal2018} employ PANIC on VAR systems so that their multivariate extension then allows for tests on the coingration rank within the idiosyncratic VECM of the individuals. The additive model is stated as
\begin{align} \label{eq:PANIC}
\begin{split}
	\boldsymbol{y}_{it} \ & = \ \Lambda_i' \boldsymbol{F}_t + \boldsymbol{y}^{i \! d}_{it}, \\
	\boldsymbol{y}^{i \! d}_{it} \ & = \boldsymbol{\mu}_{0i} + \boldsymbol{\mu}_{1i}t + \boldsymbol{y}^{d \! t}_{it}, \\
	\boldsymbol{y}^{d \! t}_{it} \ & = A_{i1} \boldsymbol{y}^{d \! t}_{i,t-1} + \ldots + A_{i,p_i} \boldsymbol{y}^{d \! t}_{i,t-p_i} + \boldsymbol{u}^{d \! t}_{it} \\
	(1-L) \boldsymbol{F}_t & = C(L) \boldsymbol{u}^{F}_t.
\end{split}
\end{align}
The idea of PANIC is to perform separate analyses on the common factor $ \boldsymbol{F}_t $ and the idiosyncratic component $ \boldsymbol{y}^{i \! d}_{it} $, both being part of the observable multivariate time series $ \boldsymbol{y}_{it} $. Hence firstly, factors $ \boldsymbol{f}_t $ and heterogeneous loadings $ \Lambda_i $ are estimated via PCA on the first-differenced data matrix of dimension $ (T-1) \times (K \cdot N) $. If unknown, the number of underlying factors can be chosen according to information criteria by \citet{BaiNg2002} or \cite{Onatski2010} as illustrated in Section~\ref{sec:MERM}. The factors $ \boldsymbol{\hat{F}}_t = \sum_{j=1}^{t} \boldsymbol{\hat{f}}_j $ with initial $ \boldsymbol{\hat{f}}_1 = \boldsymbol{0}_L $ are re-accumulated into levels to estimate the idiosyncratic component $ \boldsymbol{\hat{y}}^{i \! d}_{it} = \boldsymbol{y}_{it} - \hat{\Lambda}_i' \boldsymbol{\hat{F}}_t $. While PCA generates orthogonal factors $ \boldsymbol{\hat{f}}_t $ normalized to an identity covariance matrix, the re-accumulated factors $ \boldsymbol{\hat{F}}_t $ are usually \textit{oblique} and described by a single VAR model. The VAR process of $ \boldsymbol{{F}}_t $ can further contain common structural breaks from $ \boldsymbol{y}_{it} $ such that, for instance, \citet{Oersal2017} resorts to JMN \citeyearpar{JohansenEtAl2000} for testing the cointegration rank of $ \boldsymbol{\hat{F}}_t $.

Since $ \boldsymbol{F}_t $ is assumed to be the exclusive source of cross-sectional dependence, the idiosyncratic VECM of $ \boldsymbol{y}^{i \! d}_{it} $ are independent across individuals $ i $ and the basic methodology of first-generation tests is valid again. \citet{ArsovaOersal2017} use the approach of meta-analytical combination of the idiosyncratic $p$-values and \citet{ArsovaOersal2018} the averaged test statistics. Accordingly, the nested hypotheses of Eq.~\eqref{eq:Hypothesis} about $ r_{H0} $ refer to idiosyncratic cointegration within $ \boldsymbol{y}^{i \! d}_{it} $ and, for conclusions on conintegration within the observable $ \boldsymbol{y}_{it} $, the non-stationary properties of $ \boldsymbol{F}_t $ need to receive attention. Individual unit root and cointegration tests can be applied to the common factors $ \boldsymbol{F}_t $ and their VAR process. If all series in $ \boldsymbol{F}_t $ are stationary, panel test results on $ \boldsymbol{y}^{i \! d}_{it} $ hold equally for $ \boldsymbol{y}_{it} $. If $ \boldsymbol{F}_t $ contains stochastic trends, those enter the the observable variables $ \boldsymbol{y}_{it} $, too. In this case, they can confound the interpretation, for example, if some of the heterogeneous loadings $ \Lambda_i $ are zero and thus do not let stochastic trends in $ \boldsymbol{F}_t $ drive the variables $ \boldsymbol{y}_{it} $ equally.

For testing the cointegration rank in each idiosyncratic component, Arsova and Örsal \citeyearpar{ArsovaOersal2017,ArsovaOersal2018} consider two individual procedures: The \citeauthor{Johansen1988} test applied to $ \boldsymbol{y}^{i \! d}_{it} $ directly and the SL-test applied to $ \boldsymbol{y}^{d \! t}_{it} $ after the GLS-based trend adjustment. The SL-test based on the defactored and detrended series $ \boldsymbol{y}^{d \! t}_{it} $ assesses only the null hypothesis of no cointegration. For $ r_{H0} > 0 $ in the sequential test, the $ r_\perp = K - r_{H0} $ stochastic trends in the rank-restricted VECM are calculated as $ \beta_{\perp i}' \boldsymbol{y}^{i \! d}_{it} $. Arsova and Örsal \citeyearpar{ArsovaOersal2017,ArsovaOersal2018} then apply the SL-test to the presumably $ r_\perp $ stochastic trends under the $ H_0 $ of no cointegration in order to test the equivalent $ H_0 $ of rank $ r_{H0} $ in the idiosyncratic process of $ \boldsymbol{y}^{i \! d}_{it} $. 

Defactoring adds a linear trend to the estimated series $ \boldsymbol{\hat{y}}^{i \! d}_{it} $ inevitably, which affects the distribution of $ Z_{r_\perp} $ for both, SL- and \citeauthor{Johansen1988} test. For deriving individual $p$-values via the gamma approximation as in Eq.~\eqref{eq:GammaParameter} or for standardizing the LR-bar panel test statistic as in Eq.~\eqref{eq:LRbar}, the panel tests rely on the moments of $ Z_{r_\perp} $ which \citet[Appendix, Tab.~A.1]{ArsovaOersal2018} have simulated and tabulated. The moments depend on $ r_\perp $ and the prescribed deterministic trend, but not on the common factors $ \boldsymbol{F}_t $. Likewise, they can be calculated via the response surface regression model by \citet{Trenkler2008} using the coefficients for the case of a deterministic trend.\footnote{For an illustration, compare the results of the \proglang{R} commands:\\ \code{
	R> pvars:::coint\_moments\$SL\_trend[12:1, ] \\ 
	R> pvars:::aux\_CointMoments(dim\_K=12, rs\_coef=pvars:::coint\_rscoef[["SL\_trend"]]) }}
Note that \citet{ArsovaOersal2017} do not propose to combine individual $p$-values from defactored \citeauthor{Johansen1988} tests originally. However, \pkg{pvars} implements this in accordance with the convergence result of $ Z_{r_\perp} $ implied by \citet[p.~1041, Th.~3.4]{ArsovaOersal2018}. 


\textbf{Correlated probits.} Cross-sectional dependence between the individual entities induces correlation between the probits $ \Phi^{-1} \left( p_i \right) $ of the individual cointegration tests. In order to correct for the this and robustify the inverse normal test of Eq.~\eqref{eq:Choi_Z}, \citet{ArsovaOersal2020} combine individual $p$-values from the SL-procedure with Hartung's \citeyearpar{Hartung1999} modifications and with their own \textit{correlation-augmented inverse normal} (CAIN) test. The panel test statistic for the modified combination approach is given by
\begin{align} \label{eq:CAIN}
\begin{split}
	t(\tilde{\rho}) & = \frac{ \sum_{i=1}^{N} \Phi^{-1} \left( p_i \right) }{\sqrt{ N + \left( N^2-N \right) \cdot \tilde{\rho}^\bullet_\text{probit} }} \ \overset{d}{\longrightarrow} \ \mathcal{N}(0,1) \quad \text{with} \\ % left-tailed test
	\tilde{\rho}^{\text{HA}}_\text{probit} & = \hat{\rho}^*_\text{probit} + \kappa \cdot \sqrt{ \frac{2}{ \left( N+1 \right) }} \left( 1 - \hat{\rho}^*_\text{probit} \right)  \quad \text{or} \\
	\tilde{\rho}^{\text{CAIN}}_\text{probit} & = g\left( \rho_\epsilon, K, r_{H0} \right). 
\end{split}
\end{align}
The correction factor $ \tilde{\rho}^{\text{HA}}_\text{probit} $ by \citet{Hartung1999} is based on his unbiased and consistent estimator $ \hat{\rho}^*_\text{probit} = \max \lbrace - \frac{1}{N-1}, \ 1 - s_{N-1}^2 \left( \Phi^{-1} \left( p_i \right) \right) \rbrace $ of the probit correlation, where $ s_{N-1}^2(\cdot) $ denotes the unbiased sample variance. For the scaling factor $ \kappa $, he proposes $ \kappa_1 = 0.2 $ and, additionally, $ \kappa_2 = 0.1 \cdot \left( 1 + \frac{1}{N-1} - \hat{\rho}^*_\text{probit} \right) $ ``working mainly for smaller $ \hat{\rho}^*_\text{probit} $'' \citep[p.~853]{Hartung1999}. He does not state any decision criterion to distinguish between the intervals of smaller and larger values of $ \hat{\rho}^*_\text{probit} $ however.

The correction factor $ \tilde{\rho}^{\text{CAIN}}_\text{probit} $ by \citet{ArsovaOersal2020} is the empirical estimate of the average correlation between the individual probits. For translating cross-sectional dependency within the data panel into $ \tilde{\rho}^{\text{CAIN}}_\text{probit} $, the authors provide response surface regression coefficients for the regression model $ g\left( \rho_\epsilon, K, r_{H0} \right) $. Therein, the number of endogenous variables $ K $ and the tested cointegration rank $ r_{H0} $ follow directly from the model resp.~test specification. The \textit{average absolute pairwise cross-sectional correlation} $ \rho_\epsilon $ between the residuals is estimated for $ r_{H0} = 0 $ only and then used for all $ r_{H0} $ of the sequential testing procedure up to $ r_{H0} = K-1 $. The estimator for this mean sample correlation of the residuals within the \textit{same} variable $ k=1,\ldots,K $ and between the different individuals is
\begin{align} \label{eq:crossCor}
\begin{split}
	\hat{\rho}_\epsilon & = \frac{2}{K \cdot N \cdot (N-1)} \sum_{k=1}^{K} \sum_{i=1}^{N} \sum_{j=i+1}^{N} | \hat{\rho}_{ki,kj} |. 
\end{split}
\end{align}
Since \citet{ArsovaOersal2020} assume that the pairwise correlations between the residuals of \textit{different} variables converge to zero for $ N \to \infty $, the sample correlations $ \hat{\rho}_{ki,k^*j}, \ k \neq k^*, $ are omitted in Eq.~\eqref{eq:crossCor}. In doing so, the cross-sectional correlation between variables does not reduce the average of the presumably stronger ``within''-correlations, which mitigates the hazard of underestimating $ \rho_\epsilon $. Only if the empirical ``between''-correlation surpasses ``within''-correlation, $ \hat{\rho}_\epsilon $ could actually understate cross-sectional dependence.

If the individual, potentially heterogeneous break periods $ \boldsymbol{\tau}_i $ and the number of breaks are known, this third-generation panel test can also respect trend breaks in the cointegration relationship. For this, the individual GLS-based trend-adjustment by \citet{TrenklerEtAl2008} removes the deterministic component from the observed time series of Eq.~\eqref{eq:addDGP} including up to two trend breaks. Then, the standard LR-test procedure is applied under consideration of the trend-break specific test distribution. The individual $p$-values are combined as described in Eq.~\eqref{eq:CAIN} in order to account for the cross-sectional dependence.



\subsubsection{Identifying structure}
In comparison to the individual time series analysis, the cross-section dimension of the panel data enables additional ways to identify structural shocks $ \boldsymbol{\epsilon}_{it} = \mathsf{B}_i^{-1} \boldsymbol{u}_{it} $ from the $ K $ reduced-form errors $ \boldsymbol{u}_{it} $ of VAR~\eqref{eq:VAR}. The identification across the individuals $ i=1,\ldots,N $ may start with normalizing $ \boldsymbol{u}_{it} $ to unit-variance by $ \textsf{B}_{\sigma i} = \text{diag}\left( \sigma_{u,1i}, \ldots, \sigma_{u,Ki} \right) $ such that the structural decomposition concentrates on the residual correlation matrix
\begin{align}
\begin{split}
	&\Omega_{u,i} := \textsf{B}_{\sigma i}^{-1} \Sigma^{\ }_{u,i} \textsf{B}_{\sigma i}^{-1} = \textsf{B}_{\Omega i}^{\ } \mathsf{Q}_i^{\ } \mathsf{Q}_i' \textsf{B}_{\Omega i}' \\
	\text{ with } & \textsf{B}_{\Omega i} := \text{chol}\left( \Omega_{u,i} \right) \text{ and } \mathsf{Q}_i^{\ } \mathsf{Q}_i' = \mathsf{Q}_i^{\ } \mathsf{Q}_i^{-1} = I_K.
\end{split}
\end{align}
The usual Cholesky decomposition $ \textsf{B}_{i} \left( \boldsymbol{0} \right) := \text{chol}\left( \Sigma_{u,i} \right) = \textsf{B}_{\sigma i} \cdot \text{chol}\left( \Omega_{u,i} \right) $ generates \textit{whitened} shocks $ \boldsymbol{\epsilon_0}_{it} = \mathsf{B}_i \left( \boldsymbol{0} \right)^{-1} \boldsymbol{u}_{it} $, which already conform with the defining $ \boldsymbol{\epsilon_0}_{it} \sim ( 0, I_K ) $ after scaling $ \left( \textsf{B}_{\sigma i}^{-1} \right) $ and de-correlating $ \left( \textsf{B}_{\Omega i}^{-1} \right) $ the zero-mean vector $ \boldsymbol{u}_{it} $. Further, matrix $ \mathsf{Q}_i $ is orthogonal and can be a product of $ K(K-1)/2 $ Givens rotation matrices, which map from the tuple of rotation angles $ \boldsymbol{\theta}_i $ to the total set of candidate shocks $ \boldsymbol{\epsilon_\theta}_{it} = \mathsf{Q} \left( \boldsymbol{\theta}_i \right)^{-1} \boldsymbol{\epsilon_0}_{it} $ and their impact matrices $ \mathsf{B}_i \left( \boldsymbol{\theta}_i \right) = \textsf{B}_{i} \left( \boldsymbol{0} \right) \mathsf{Q} \left( \boldsymbol{\theta}_i \right) $. As the identification procedures rely on estimated $ \boldsymbol{\widehat{u}}_{it} $, the candidate samples $ \mathcal{A}_{\boldsymbol{\theta}}^{\text{(i)}} = \{ \boldsymbol{\widehat{\epsilon}_\theta}_{it} \}^T_{t=1} $ of dimension $ K \times T $ involve the usual issues of individual SVAR with small or medium-sized time series. The panel methods presented in the following offer the advantage of \textit{(i)} increasing the power of dependence tests in ICA and of \textit{(ii)} accommodating structural information from cross-sectional dependence.
\begin{figure}[ht]	% fig:PSAVR
	\centering
	\caption{Panel SVAR identification by ICA in \citet{Herwartz2017}.}
	\resizebox{0.75\textwidth}{!}{
		\input{images/Fig_PSVAR.tex}}
	\label{fig:PSVAR}
\end{figure}


\textbf{Common rotation.} \citet{Herwartz2017} propose and evaluate the pooled identification procedure stylized in Figure~\ref{fig:PSVAR}. An individual decomposition $ \ \boldsymbol{\epsilon_\theta}_{it} = \mathsf{Q} \left( \boldsymbol{\theta} \right)^{-1} \textsf{B}_{\Omega i}^{-1} \mathsf{B}_{\sigma i}^{-1} \boldsymbol{u}_{it} $ allows for a common rotation $ \mathsf{Q} \left( \boldsymbol{\theta} \right) $ of the whitened shocks while accounting for heterogeneous variances and cross-variable correlations in $ \boldsymbol{u}_{it} $. Among competing \textit{pooled samples} $ \mathcal{A}_{\boldsymbol{\theta}}^{(N)} = \{ \{ \boldsymbol{\widehat{\epsilon}_\theta}_{it} \}^T_{t=1} \}^N_{i=1} $ of dimension $ K \times (T \cdot N) $, the ICA then determines the least dependent shocks $ \boldsymbol{\widehat{\epsilon}_{\widehat{\theta}}}_{it} $ with optimal $ \boldsymbol{\widehat{\theta}} $, from which $ \widehat{\mathsf{B}}_i $ is recovered for each individual.


\textbf{Common shocks.} \citet{CalhounEtAl2002} propose \textit{group ICA} and apply this to panel data originating from functional Magnetic Resonance Imaging (fMRI) of brains. In the same empirical context, \citet{RiskEtAl2014} evaluate ICA algorithms, which can be applied to the panel of reduced-form errors $ \boldsymbol{u}_{it} $ alike. Accordingly, their model $ \boldsymbol{u}_{it} = \mathsf{B}_i \boldsymbol{\epsilon}_{t} + \boldsymbol{e}_{it} $ consists of $ L $ common shocks $ \boldsymbol{\epsilon}_{t} $ and some idiosyncratic noise $ \boldsymbol{e}_{it} $ \citep[p.~227]{RiskEtAl2014}. In a two-step PCA, they firstly whiten each individual sample $ \left[\boldsymbol{\widehat{u}}_{i1}: \ldots: \boldsymbol{\widehat{u}}_{iT} \right]' = \mathsf{U}_i^{\ } \mathsf{D}_i^{\ } \mathsf{V}_i' $ by compact \textit{singular value decomposition} such that $ \mathcal{A}_i := \sqrt{T} \mathsf{U}_i' $ has an identity covariance matrix $ I_K $. They further factorize the $ T \times (K \cdot N) $ concatenated samples $ \left[ \mathcal{A}_1' : \ldots : \mathcal{A}_N' \right] = \mathsf{U} \mathsf{D} \mathsf{V}' $ and utilize the first $ L $ columns of left singular-vectors to construct a $ L \times T $ baseline sample $ \mathcal{A}_{\boldsymbol{0}}^{(2S)} := \sqrt{T} \mathsf{U}_{1:L}' $. The ICA, which becomes noise-free after this data reduction, then determines the least dependent common shocks $ \boldsymbol{\widehat{\epsilon}_{\widehat{\theta}}}_t $. The multivariate least squares regression of $ \boldsymbol{\widehat{u}}_{it} $ on $ \boldsymbol{\widehat{\epsilon}_{\widehat{\theta}}}_t $ recovers the $ K \times L $ impact matrices $ \mathsf{\widehat{B}}_i, \ \forall i=1\ldots,N $.


\textbf{ICA.} If at most one of the shocks is Gaussian, the \textit{independent component analysis} as established by \citet{Comon1994} can determine the rotation angles $ \boldsymbol{\widehat{\theta}}^{\bullet} $ and thereby identify the impact matrix $ \widehat{\mathsf{B}}_i^{\bullet} $ of the methods $ \bullet \in \lbrace (i), (N), (2S) \rbrace $. For this purpose, dependence measures $ \mathcal{D}(\cdot) $ discriminate between the candidates of whitened shocks $ \mathcal{A}_{\boldsymbol{\theta}}^{\bullet} = \mathsf{Q} \left( \boldsymbol{\theta} \right)^{-1} \mathcal{A}_{\boldsymbol{0}}^{\bullet} $ by dependencies beyond the second moment. In the spirit of Hodge-Lehmann estimation \citeyearpar{HodgesLehmann1963}, a minimization procedure $ \boldsymbol{\widehat{\theta}}^{\bullet} = \text{argmin}_{\boldsymbol{\theta}} \ \mathcal{D} \left( \mathcal{A}_{\boldsymbol{\theta}}^{\bullet} \right) $ finds the rotation angels $ \boldsymbol{\widehat{\theta}}^{\bullet} $ of the least dependent shocks. 

ICA can identify shocks and impact matrices up to to scaling, column signs, and ordering only. For example in the case of $ K=2 $, the relevant interval of a full rotation $ \theta \in (0, 2\pi] $ reduces to a quadrant, e.g.~$ \theta \in (0, \pi/2] $, since any exceeding rotation just permutes the ordering and reverses signs. If $ \theta \in (\pi/2, 2\pi] $, the results of $ \mathcal{D} \left( \mathcal{A}_{\boldsymbol{\theta}}^{\bullet} \right) $ including the minima would be identical to those of the first quadrant. Against this ambiguity, a common practice for the unique identification of $ \mathsf{B}_i $ is to \textit{(1)} choose the column ordering which maximizes the sum of the absolute diagonal elements and \textit{(2)} then switch signs of those columns whose main diagonal element turns out to be negative. Under $ \boldsymbol{\epsilon}_{it} \sim ( 0, I_K ) $, each shock is thereby attributed to the variable on which it has the strongest effect on impact.

ICA-based identification procedures for the individual SVAR are already implemented in \pkg{svars}. As we focus on their embedding into a panel framework, we just list them here briefly and refer the reader to the accompanying vignette \citep{LangeEtAl_fc} for a comprehensive overview and to the Monte Carlo study \citep{HerwartzEtAl2021} for a performance assessment. The following dependence measures $ \mathcal{D}\left( \cdot \right) $ and optimization procedures are adopted in \pkg{pvars}: The \textit{Cramér-von-Mises} (cvm) \textit{distance} by \citet{GenestEtAl2007} is used in \pkg{svars}' two-step optimization procedure with \pkg{copula} \citep{KojadinovicYan2010} and has been exemplarily applied for individual SVAR by \citet{Herwartz2018}. The \textit{distance covariance} (dCov) by \cite{Szekely2007} is used in the gradient algorithm of \pkg{steadyICA} \citep{RiskEtAl2015} and has been applied for SVAR by \citet{MattesonTsay2017}. The \textit{dependence coefficient} (dCoef) by \citet{BakirovEtAl2006} is not used in \pkg{svars} and \pkg{pvars}.\footnote{Note that dCoef and dCov are implemented in \pkg{energy} by \citet{RizzoSzekely2022}.} 


